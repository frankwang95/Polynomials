(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16658,        371]
NotebookOptionsPosition[     16370,        357]
NotebookOutlinePosition[     16717,        372]
CellTagsIndexPosition[     16674,        369]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fileloc", " ", "=", " ", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<data\>\""}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"out", " ", "=", " ", 
    RowBox[{"OpenWrite", " ", "[", "fileloc", "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", " ", "=", " ", "9"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"coefficients", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", " ", "0", ",", " ", "1"}], "}"}]}], ";"}], 
  " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"polyGen", "[", "list_", "]"}], " ", ":=", " ", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#1", "*", 
           RowBox[{"x", "^", "#2"}]}], " ", "&"}], " ", ")"}], " ", "@@", " ",
         "#1"}], " ", "&"}], " ", ")"}], " ", "/@", " ", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"list", ",", " ", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", " ", "deg"}], "]"}]}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tupList", "[", "1", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", "1", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tupList", "[", "n_", "]"}], ":=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
       RowBox[{"Tuples", "[", 
        RowBox[{"coefficients", ",", 
         RowBox[{"n", "-", "1"}]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", "0"}], "]"}], "&"}], "/@", 
       RowBox[{"tupList", "[", 
        RowBox[{"n", "-", "1"}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"results", " ", "=", " ", 
   RowBox[{"ParallelMap", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NSolve", "[", 
       RowBox[{
        RowBox[{"#", "==", "0"}], ",", "x"}], "]"}], "&"}], ",", 
     RowBox[{"polyGen", "/@", 
      RowBox[{"tupList", "[", 
       RowBox[{"deg", "+", "1"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Write", "[", 
  RowBox[{"out", ",", "results"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "out", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.645893247699139*^9, 3.645893249477265*^9}, {
   3.6458933404127045`*^9, 3.6458933605709815`*^9}, {3.645893396073272*^9, 
   3.6458934018378363`*^9}, {3.645893476250574*^9, 3.6458934763965197`*^9}, {
   3.6458935568594418`*^9, 3.6458935775199537`*^9}, {3.6458936551868525`*^9, 
   3.6458937608608685`*^9}, {3.645893798909287*^9, 3.6458938508263817`*^9}, {
   3.6458939044004*^9, 3.645893971342986*^9}, {3.6458940029650774`*^9, 
   3.6458940399196944`*^9}, {3.64589415563767*^9, 3.6458942188465414`*^9}, {
   3.6458942499514303`*^9, 3.645894258952908*^9}, {3.645894395432578*^9, 
   3.645894422396349*^9}, {3.645894732197645*^9, 3.6458950042159047`*^9}, {
   3.645895043395838*^9, 3.645895076889535*^9}, {3.645895120437369*^9, 
   3.645895132947503*^9}, {3.6458951653166604`*^9, 3.6458952007799826`*^9}, {
   3.645895240067049*^9, 3.645895281783928*^9}, {3.645895549343712*^9, 
   3.645895727239947*^9}, {3.6458958118636265`*^9, 3.645895818977891*^9}, {
   3.645896260302248*^9, 3.645896332811003*^9}, {3.6458964588187714`*^9, 
   3.6458964605218253`*^9}, {3.6458964917217245`*^9, 3.645896492813944*^9}, {
   3.6458966080254927`*^9, 3.6458966129077406`*^9}, {3.6458966638589983`*^9, 
   3.645896674838114*^9}, {3.645897150728641*^9, 3.645897151634785*^9}, {
   3.6458971990960245`*^9, 3.6458972605580626`*^9}, {3.64589730490897*^9, 
   3.645897320781789*^9}, {3.6458974624693184`*^9, 3.64589746264573*^9}, {
   3.64589760275452*^9, 3.645897609542222*^9}, {3.6458977742152987`*^9, 
   3.6458977800695877`*^9}, {3.645897838540412*^9, 3.6458978777965126`*^9}, {
   3.645897922685154*^9, 3.6458979269386005`*^9}, {3.645897966775731*^9, 
   3.645898011638198*^9}, {3.6458980416455555`*^9, 3.645898072537629*^9}, {
   3.6458981171996584`*^9, 3.6458981909317102`*^9}, {3.645898305114188*^9, 
   3.645898324487211*^9}, {3.6458983915022893`*^9, 3.6458983994322014`*^9}, {
   3.6458984309050198`*^9, 3.645898472000023*^9}, {3.645898564821183*^9, 
   3.6458986280545087`*^9}, {3.645898734272565*^9, 3.6458987614363785`*^9}, {
   3.645898946529306*^9, 3.6458990638186584`*^9}, {3.645899099414327*^9, 
   3.645899099845105*^9}, {3.6458991588625464`*^9, 3.6458991598531218`*^9}, {
   3.6459680869071164`*^9, 3.6459683060398273`*^9}, {3.6459685277995567`*^9, 
   3.6459685576050034`*^9}, {3.6459686129555426`*^9, 3.64596861360359*^9}, {
   3.645968871214325*^9, 3.6459688910796185`*^9}, {3.64596938520419*^9, 
   3.6459694286450224`*^9}, {3.64597053769092*^9, 3.645970551461837*^9}, {
   3.6459709421164503`*^9, 3.6459709668680134`*^9}, {3.645972735227295*^9, 
   3.645972745067035*^9}, {3.645972790664623*^9, 3.6459728615925293`*^9}, {
   3.6459729840498643`*^9, 3.645973006876911*^9}, {3.645973427905094*^9, 
   3.645973565620611*^9}, 3.6459738601909595`*^9, {3.645973907176975*^9, 
   3.645973940202007*^9}, {3.6459741884086943`*^9, 3.6459742536766014`*^9}, {
   3.645974318527554*^9, 3.6459743443109274`*^9}, {3.6459744361826377`*^9, 
   3.645974537488859*^9}, {3.6459745937990885`*^9, 3.645974607134884*^9}, {
   3.645974690251401*^9, 3.6459747209100122`*^9}, {3.6459747559223595`*^9, 
   3.6459748056136208`*^9}, {3.6459750419349465`*^9, 
   3.6459751897751627`*^9}, {3.645975231311511*^9, 3.6459752441918817`*^9}, {
   3.64597531293482*^9, 3.6459754304380956`*^9}, {3.6459754749572697`*^9, 
   3.6459754998385344`*^9}, {3.6459761146305757`*^9, 3.6459761926913*^9}, {
   3.6459762234198003`*^9, 3.6459762784595504`*^9}, {3.645976382232255*^9, 
   3.645976433122858*^9}, {3.6459764772955236`*^9, 3.645976574703148*^9}, {
   3.64597660512868*^9, 3.645976690301402*^9}, {3.6459767609654016`*^9, 
   3.645976786358669*^9}, {3.645976824015061*^9, 3.645976859221726*^9}, {
   3.645976970959257*^9, 3.6459769767489333`*^9}, {3.645977200077894*^9, 
   3.64597725506236*^9}, {3.6459773503336115`*^9, 3.6459774807895346`*^9}, {
   3.6459775110359592`*^9, 3.645977580917672*^9}, {3.645977652519388*^9, 
   3.645977783133229*^9}, {3.6459781192261825`*^9, 3.6459781409331694`*^9}, {
   3.64597822003781*^9, 3.6459782916889353`*^9}, 3.645978354641261*^9, {
   3.6459784223390894`*^9, 3.6459784404712825`*^9}, {3.645978499940237*^9, 
   3.6459785031680803`*^9}, {3.645978575298994*^9, 3.6459785772643423`*^9}, {
   3.645978715760251*^9, 3.645978733155885*^9}, {3.645978780510106*^9, 
   3.645978865129526*^9}, {3.6459789207948503`*^9, 3.64597906420315*^9}, {
   3.6459791212694416`*^9, 3.6459791469638796`*^9}, {3.6459793664361353`*^9, 
   3.645979392932165*^9}, {3.6459794256434927`*^9, 3.6459795024431343`*^9}, {
   3.645979627971052*^9, 3.6459797126363935`*^9}, {3.645979784256854*^9, 
   3.6459797977363663`*^9}, {3.6459799199421773`*^9, 
   3.6459799323569956`*^9}, {3.6459799751187277`*^9, 3.645979999541316*^9}, {
   3.6459800541789694`*^9, 3.6459800626270742`*^9}, 3.6459836620009613`*^9, {
   3.645984135150345*^9, 3.645984146782384*^9}, {3.6459841785738077`*^9, 
   3.645984268710288*^9}, {3.645984529572033*^9, 3.645984574617507*^9}, {
   3.645985092824914*^9, 3.6459851341432567`*^9}, {3.645985198779704*^9, 
   3.6459852311960354`*^9}, {3.6459852678931413`*^9, 3.645985314731909*^9}, {
   3.645985362432136*^9, 3.645985387710662*^9}, {3.645985440071046*^9, 
   3.6459854416774845`*^9}, {3.6459855168665094`*^9, 
   3.6459856043263893`*^9}, {3.6459856506948557`*^9, 
   3.6459857660948935`*^9}, {3.6459858003958235`*^9, 
   3.6459858006302013`*^9}, {3.6459861184831443`*^9, 3.645986140288633*^9}, {
   3.6459862518810005`*^9, 3.645986282133643*^9}, {3.645986315886746*^9, 
   3.6459863438008127`*^9}, 3.645987299498888*^9, {3.645987374792263*^9, 
   3.645987377366637*^9}, {3.646008624456995*^9, 3.646008652521483*^9}, {
   3.6460087089740996`*^9, 3.646008715954832*^9}, {3.6460087586340985`*^9, 
   3.6460087625367513`*^9}, {3.646009723663315*^9, 3.646009725539832*^9}, {
   3.646009851614482*^9, 3.6460098559556475`*^9}, {3.646010023029501*^9, 
   3.6460100577773933`*^9}, {3.646010123195262*^9, 3.6460101234605274`*^9}, {
   3.646016533684004*^9, 3.6460165579236445`*^9}, {3.646016636035488*^9, 
   3.6460166362185926`*^9}, {3.646053554010908*^9, 3.646053572367079*^9}, {
   3.6460539959333515`*^9, 3.646054036983381*^9}, {3.64605407011992*^9, 
   3.6460540915354567`*^9}, {3.646054422112213*^9, 3.646054456869136*^9}, {
   3.6460546166435375`*^9, 3.6460546247636747`*^9}, {3.646054710210559*^9, 
   3.6460547262706194`*^9}, {3.646055299820775*^9, 3.646055355507243*^9}, {
   3.6460554184600325`*^9, 3.6460554423269205`*^9}, {3.6460735276908655`*^9, 
   3.6460735351892443`*^9}, {3.646075350699864*^9, 3.6460753853640547`*^9}, {
   3.646075891381829*^9, 3.6460758915224543`*^9}, {3.646076354615819*^9, 
   3.646076356430809*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetSystemOptions", "[", 
   RowBox[{"\"\<SparseArrayOptions\>\"", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<TreatRepeatedEntries\>\"", "\[Rule]", "1"}], "}"}]}], "]"}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Gamma]", "=", "0.07"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Beta]", "=", "1.05"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"fLor", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Gamma]", "/", 
        RowBox[{"(", 
         RowBox[{"\[Gamma]", "+", 
          RowBox[{"x", "^", "2"}], "+", 
          RowBox[{"y", "^", "2"}]}], ")"}]}], ")"}], "^", "\[Beta]"}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"<<", "Developer`"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$PlotComplexPoints", "[", 
    RowBox[{
    "list_", ",", "magnification_", ",", "paddingX_", ",", "paddingY_", ",", 
     "brightness_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RePos", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"paddingX", "+", "1", "+", 
           RowBox[{"Round", "[", 
            RowBox[{"magnification", " ", 
             RowBox[{"(", 
              RowBox[{"#", "-", 
               RowBox[{"Min", "[", "#", "]"}]}], ")"}]}], "]"}]}], "&"}], "[", 
         RowBox[{"Re", "[", "list", "]"}], "]"}]}], ",", 
       RowBox[{"ImPos", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"paddingY", "+", "1", "+", 
           RowBox[{"Round", "[", 
            RowBox[{"magnification", " ", 
             RowBox[{"(", 
              RowBox[{"#", "-", 
               RowBox[{"Min", "[", "#", "]"}]}], ")"}]}], "]"}]}], "&"}], "[", 
         RowBox[{"Im", "[", "list", "]"}], "]"}]}], ",", "sparse", ",", "lor",
        ",", "dimX", ",", "dimY"}], "}"}], ",", 
     RowBox[{
      RowBox[{"dimX", "=", 
       RowBox[{"paddingX", "+", 
        RowBox[{"Max", "[", "RePos", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dimY", "=", 
       RowBox[{"paddingY", "+", 
        RowBox[{"Max", "[", "ImPos", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Image", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"brightness", " ", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"dimX", " ", "dimY"}], "]"}], " ", 
           RowBox[{"Abs", "[", 
            RowBox[{"InverseFourier", "[", 
             RowBox[{
              RowBox[{"Fourier", "[", 
               RowBox[{"SparseArray", "[", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"ImPos", ",", "RePos"}], "}"}], "\[Transpose]"}], 
                   "\[Rule]", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"Length", "[", "list", "]"}]}], "]"}]}], "]"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"dimY", ",", "dimX"}], "}"}]}], "]"}], "]"}], " ", 
              RowBox[{"Fourier", "[", 
               RowBox[{"RotateRight", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"fLor", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "All", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}]}], 
                    "]"}], "&"}], "@", 
                  RowBox[{"Outer", "[", 
                   RowBox[{"List", ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"dimY", "/", "2"}], "]"}]}], ",", 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dimY", "-", "1"}], ")"}], "/", "2"}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"dimX", "/", "2"}], "]"}]}], ",", 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dimX", "-", "1"}], ")"}], "/", "2"}], "]"}]}], 
                    "]"}]}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Floor", "[", 
                    RowBox[{"dimY", "/", "2"}], "]"}], ",", 
                   RowBox[{"Floor", "[", 
                    RowBox[{"dimX", "/", "2"}], "]"}]}], "}"}]}], "]"}], 
               "]"}]}], "]"}], "]"}]}], ")"}], "\[TensorProduct]", 
         RowBox[{"ToPackedArray", "[", 
          RowBox[{"{", 
           RowBox[{"1.0", ",", "0.3", ",", "0.1"}], "}"}], "]"}]}], ",", 
        RowBox[{"Magnification", "\[Rule]", "1"}]}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"$PlotComplexPoints", "[", 
  RowBox[{
   RowBox[{"x", "/.", 
    RowBox[{"Apply", "[", 
     RowBox[{"Union", ",", "results"}], "]"}]}], ",", "300", ",", "20", ",", 
   "20", ",", "1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6460736816980124`*^9, 3.646073695757516*^9}, {
   3.6460748833101597`*^9, 3.646074914850707*^9}, {3.6460750024572124`*^9, 
   3.6460750506634336`*^9}, {3.6460750820482655`*^9, 3.646075084597469*^9}, 
   3.646075146313243*^9, {3.6460751790140753`*^9, 3.646075215518549*^9}, 
   3.646075341046261*^9, {3.646075414613306*^9, 3.646075457821273*^9}, {
   3.646075488871045*^9, 3.6460755317015104`*^9}, {3.6460756319375615`*^9, 
   3.6460756570655446`*^9}, {3.6460757007075853`*^9, 3.6460759396154375`*^9}, 
   3.6460759941068153`*^9, {3.646076041967471*^9, 3.646076064233864*^9}, {
   3.646076199696748*^9, 3.6460762259497485`*^9}, {3.646076418032518*^9, 
   3.64607645401458*^9}, {3.646076543877778*^9, 3.6460766350010023`*^9}}]
},
WindowSize->{1920, 1119},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 9291, 174, 272, "Input"],
Cell[9852, 196, 6514, 159, 312, "Input"]
}
]
*)

(* End of internal cache information *)
